# Nixpacks Configuration for Railway
# This file tells Nixpacks how to build the application

[phases.setup]
nixPkgs = ["nodejs_18", "pnpm"]

[phases.install]
# Skip postinstall to avoid Prisma ESM/CJS conflict
cmds = ["pnpm install --frozen-lockfile --ignore-scripts"]

[phases.build]
# Use npx instead of pnpm exec to avoid ESM/CJS issues
cmds = ["npx prisma generate", "pnpm run build"]

[start]
cmd = "pnpm run start"
